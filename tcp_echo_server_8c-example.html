<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libev: tcp_echo_server.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libev
   </div>
   <div id="projectbrief">A tiny version of libuv, but focus on no memory allocation.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('tcp_echo_server_8c-example.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">tcp_echo_server.c</div></div>
</div><!--header-->
<div class="contents">
<p>This is an example for how to use <a class="el" href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac" title="TCP socket.">ev_tcp_t</a> as tcp server.</p>
<div class="fragment"><div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ev_8h.html">ev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CHECK_SUCCESS(ret)                                                     \</span></div>
<div class="line"><span class="preprocessor">    do                                                                         \</span></div>
<div class="line"><span class="preprocessor">    {                                                                          \</span></div>
<div class="line"><span class="preprocessor">        int _ret = ret;                                                        \</span></div>
<div class="line"><span class="preprocessor">        if (_ret == 0)                                                         \</span></div>
<div class="line"><span class="preprocessor">        {                                                                      \</span></div>
<div class="line"><span class="preprocessor">            break;                                                             \</span></div>
<div class="line"><span class="preprocessor">        }                                                                      \</span></div>
<div class="line"><span class="preprocessor">        fprintf(stderr, &quot;%s:%d: %s\n&quot;, __FUNCTION__, __LINE__,                 \</span></div>
<div class="line"><span class="preprocessor">                ev_strerror(ret));                                             \</span></div>
<div class="line"><span class="preprocessor">    } while (0)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define ARRAY_SIZE(x) (sizeof(x) / sizeof(x[0]))</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>tcp_client</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_typedef" href="group__EV__UTILS__LIST.html#ga24fccfcad22348f0a471e33de0ef26af">ev_list_node_t</a> node;         <span class="comment">/* list node */</span></div>
<div class="line">    <a class="code hl_typedef" href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac">ev_tcp_t</a>      *client;       <span class="comment">/* TCP connecting token */</span></div>
<div class="line">    <span class="keywordtype">char</span>           buffer[1024]; <span class="comment">/* Receive / Send buffer */</span></div>
<div class="line">    <span class="keywordtype">char</span>           ip[64];       <span class="comment">/* Peer IP */</span></div>
<div class="line">    <span class="keywordtype">int</span>            port;         <span class="comment">/* Peer port */</span></div>
<div class="line">} tcp_client_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>tcp_echo_server_s</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_typedef" href="group__EV__EVENT__LOOP.html#gafff3c1737e3eb73728b817bc6193f28c">ev_loop_t</a>  *loop;        <span class="comment">/* Event loop */</span></div>
<div class="line">    <a class="code hl_typedef" href="group__EV__ASYNC.html#ga1f2cf42cd91d80c71a074d4f0d64f95b">ev_async_t</a> *on_sigint;   <span class="comment">/* Async handle for signal */</span></div>
<div class="line">    <a class="code hl_typedef" href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac">ev_tcp_t</a>   *sock_listen; <span class="comment">/* Listing socket */</span></div>
<div class="line">    <a class="code hl_typedef" href="group__EV__UTILS__LIST.html#ga5b3f16540f29df5627dbef22f5571b97">ev_list_t</a>   client_list; <span class="comment">/* List of client connections */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *addr;        <span class="comment">/* Listening IP address */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *port;        <span class="comment">/* Listening port */</span></div>
<div class="line">} tcp_echo_server_t;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// clang-format off</span></div>
<div class="line"><span class="keyword">static</span> tcp_echo_server_t s_tcp_echo_server = {</div>
<div class="line">    NULL,</div>
<div class="line">    NULL,</div>
<div class="line">    NULL,</div>
<div class="line">    <a class="code hl_define" href="group__EV__UTILS__LIST.html#ga2eb6fa551d8031cd5ced350f25c6451a">EV_LIST_INIT</a>,</div>
<div class="line">    <span class="stringliteral">&quot;0.0.0.0&quot;</span>,</div>
<div class="line">    NULL,</div>
<div class="line">};</div>
<div class="line"><span class="comment">// clang-format on</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if defined(SIGUSR1) &amp;&amp; defined(SIGUSR1)</span></div>
<div class="line"><span class="preprocessor">#define TERM_SIGNAL_MAP(XX)                                                    \</span></div>
<div class="line"><span class="preprocessor">    XX(SIGINT)                                                                 \</span></div>
<div class="line"><span class="preprocessor">    XX(SIGTERM)                                                                \</span></div>
<div class="line"><span class="preprocessor">    XX(SIGUSR1)                                                                \</span></div>
<div class="line"><span class="preprocessor">    XX(SIGUSR1)</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">#define TERM_SIGNAL_MAP(XX)                                                    \</span></div>
<div class="line"><span class="preprocessor">    XX(SIGINT)                                                                 \</span></div>
<div class="line"><span class="preprocessor">    XX(SIGTERM)</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define EXPAND_SIG_AS_ARRAY(SIG) SIG,</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> s_term_signal[] = { TERM_SIGNAL_MAP(EXPAND_SIG_AS_ARRAY) };</div>
<div class="line"><span class="preprocessor">#undef EXPAND_SIG_AS_ARRAY</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define EXPAND_SIG_AS_HELP(SIG) &quot;  + &quot; #SIG &quot;\n&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// clang-format off</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* s_help =</div>
<div class="line"><span class="stringliteral">&quot;USAGE: tcp_echo_server --addr=ADDR --port=PORT\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;Mandatory arguments to long options are mandatory for short options too.\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;  --addr=ADDR\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;      Set listen address.\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;  --port=PORT\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;      Set listen port.\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;  --help, -h\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;      Show this help and exit.\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;To exit normally, send one of following signals to this process:\n&quot;</span></div>
<div class="line">TERM_SIGNAL_MAP(EXPAND_SIG_AS_HELP)</div>
<div class="line">;</div>
<div class="line"><span class="preprocessor">#undef EXPAND_SIG_AS_HELP</span></div>
<div class="line"><span class="comment">// clang-format on</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _on_accept_done(<a class="code hl_typedef" href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac">ev_tcp_t</a> *lisn, <a class="code hl_typedef" href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac">ev_tcp_t</a> *conn, <span class="keywordtype">int</span> stat,</div>
<div class="line">                            <span class="keywordtype">void</span> *arg);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _want_read(tcp_client_t *client);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _setup_args(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *opt = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; argc; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(argv[i], <span class="stringliteral">&quot;--help&quot;</span>) == 0 || strcmp(argv[i], <span class="stringliteral">&quot;-h&quot;</span>) == 0)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">goto</span> print_help_and_exit;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        opt = <span class="stringliteral">&quot;--addr=&quot;</span>;</div>
<div class="line">        <span class="keywordflow">if</span> (strncmp(argv[i], opt, strlen(opt)) == 0)</div>
<div class="line">        {</div>
<div class="line">            s_tcp_echo_server.addr = argv[i] + strlen(opt);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        opt = <span class="stringliteral">&quot;--port=&quot;</span>;</div>
<div class="line">        <span class="keywordflow">if</span> (strncmp(argv[i], opt, strlen(opt)) == 0)</div>
<div class="line">        {</div>
<div class="line">            s_tcp_echo_server.port = argv[i] + strlen(opt);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (s_tcp_echo_server.port == NULL)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">goto</span> print_help_and_exit;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">print_help_and_exit:</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s&quot;</span>, s_help);</div>
<div class="line">    exit(EXIT_SUCCESS);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _on_client_close(<a class="code hl_typedef" href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac">ev_tcp_t</a> *sock, <span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    (void)sock;</div>
<div class="line">    tcp_client_t *client = (tcp_client_t *)arg;</div>
<div class="line">    printf(<span class="stringliteral">&quot;connection(%s:%d) teardown\n&quot;</span>, client-&gt;ip, client-&gt;port);</div>
<div class="line"> </div>
<div class="line">    free(client);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> submit_accept_request(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span>           ret;</div>
<div class="line">    tcp_client_t *client = calloc(1, <span class="keyword">sizeof</span>(tcp_client_t));</div>
<div class="line">    ret = <a id="a0" name="a0"></a><a class="code hl_function" href="group__EV__TCP.html#ga0e24bdafbeef554d675f83abd2e62829">ev_tcp_init</a>(s_tcp_echo_server.loop, &amp;client-&gt;client);</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line">    <a id="a1" name="a1"></a><a class="code hl_function" href="group__EV__UTILS__LIST.html#gac224bce0c5553feaff3e34c759e3a676">ev_list_push_back</a>(&amp;s_tcp_echo_server.client_list, &amp;client-&gt;node);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Here we try to accept one new connect.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * After this function success, only one new connect will be accepted,</span></div>
<div class="line"><span class="comment">     * other incoming connections will be in accept queue.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * In short, one #ev_tcp_accept() call, one connection.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    ret = <a id="a2" name="a2"></a><a class="code hl_function" href="group__EV__TCP.html#ga80e57513fc95a866f41631c6477440ca">ev_tcp_accept</a>(s_tcp_echo_server.sock_listen, client-&gt;client,</div>
<div class="line">                        _on_accept_done, client);</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _close_client(tcp_client_t *client)</div>
<div class="line">{</div>
<div class="line">    <a id="a3" name="a3"></a><a class="code hl_function" href="group__EV__UTILS__LIST.html#ga3ecb4fcafe66af1ba7d875e27e0bcadd">ev_list_erase</a>(&amp;s_tcp_echo_server.client_list, &amp;client-&gt;node);</div>
<div class="line">    <a id="a4" name="a4"></a><a class="code hl_function" href="group__EV__TCP.html#gae81875f88fcb5f948f0681cc05755176">ev_tcp_exit</a>(client-&gt;client, _on_client_close, client);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _on_write_done(<a class="code hl_typedef" href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac">ev_tcp_t</a> *sock, ssize_t size, <span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    (void)sock;</div>
<div class="line">    tcp_client_t *client = (tcp_client_t *)arg;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (size &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        _close_client(client);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    _want_read(client);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _on_read_done(<a class="code hl_typedef" href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac">ev_tcp_t</a> *sock, ssize_t size, <span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    (void)sock;</div>
<div class="line">    <span class="keywordtype">int</span>           ret;</div>
<div class="line">    tcp_client_t *client = (tcp_client_t *)arg;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (size &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        _close_client(client);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="ev_8h.html#ac4d5995eaf67533e3afcf0a417136a31">ev_buf_t</a> buf = <a id="a5" name="a5"></a><a class="code hl_function" href="group__EV__MISC.html#ga047bab4c5d508257ed3dad1e83b0af5e">ev_buf_make</a>(client-&gt;buffer, size);</div>
<div class="line">    ret = <a id="a6" name="a6"></a><a class="code hl_function" href="group__EV__TCP.html#ga2bfe44c7a94d2c476a7fc2cacd56b996">ev_tcp_write</a>(client-&gt;client, &amp;buf, 1, _on_write_done, client);</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _want_read(tcp_client_t *client)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_typedef" href="ev_8h.html#ac4d5995eaf67533e3afcf0a417136a31">ev_buf_t</a> buf = <a class="code hl_function" href="group__EV__MISC.html#ga047bab4c5d508257ed3dad1e83b0af5e">ev_buf_make</a>(client-&gt;buffer, <span class="keyword">sizeof</span>(client-&gt;buffer));</div>
<div class="line">    <span class="keywordtype">int</span>      ret = <a id="a7" name="a7"></a><a class="code hl_function" href="group__EV__TCP.html#ga4b5bd52b3f680a0d1093cbd818886cf7">ev_tcp_read</a>(client-&gt;client, &amp;buf, 1, _on_read_done, client);</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _show_connect_info(tcp_client_t *client)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>sockaddr_storage sock_addr;</div>
<div class="line">    <span class="keywordtype">size_t</span>                  sock_addr_len = <span class="keyword">sizeof</span>(sock_addr);</div>
<div class="line">    ret = <a id="a8" name="a8"></a><a class="code hl_function" href="group__EV__TCP.html#ga931b5982c7e44faa0ad7371934b0efdb">ev_tcp_getpeername</a>(client-&gt;client, (<span class="keyword">struct</span> sockaddr *)&amp;sock_addr,</div>
<div class="line">                             &amp;sock_addr_len);</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line"> </div>
<div class="line">    ret = <a id="a9" name="a9"></a><a class="code hl_function" href="group__EV__MISC__NET.html#gae12ee3b5ba3619bdfaf1002831c2f4f6">ev_ipv4_name</a>((<span class="keyword">struct</span> sockaddr_in *)&amp;sock_addr, &amp;client-&gt;port,</div>
<div class="line">                       client-&gt;ip, <span class="keyword">sizeof</span>(client-&gt;ip));</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;connection(%s:%d) setup\n&quot;</span>, client-&gt;ip, client-&gt;port);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _on_accept_done(<a class="code hl_typedef" href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac">ev_tcp_t</a> *lisn, <a class="code hl_typedef" href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac">ev_tcp_t</a> *conn, <span class="keywordtype">int</span> stat, <span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    assert(lisn == s_tcp_echo_server.sock_listen);</div>
<div class="line">    (void)lisn;</div>
<div class="line">    (void)conn;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (stat != 0)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    tcp_client_t *client = (tcp_client_t *)arg;</div>
<div class="line">    _show_connect_info(client);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* No matter what result it is, we want to accept more connections. */</span></div>
<div class="line">    submit_accept_request();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* If accept failed, destroy resource */</span></div>
<div class="line">    <span class="keywordflow">if</span> (stat != 0)</div>
<div class="line">    {</div>
<div class="line">        _close_client(client);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    _want_read(client);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _at_exit(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * At this point, the means the #main() function has returned, and all</span></div>
<div class="line"><span class="comment">     * ev handles except #s_tcp_echo_server::loop have been closed.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * So close event loop, so that all resource is new released.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a id="a10" name="a10"></a><a class="code hl_function" href="group__EV__EVENT__LOOP.html#gaf0b54be09a1971f5acf20fb38cf5e1a5">ev_loop_exit</a>(s_tcp_echo_server.loop);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _close_listen_socket()</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="group__EV__TCP.html#gae81875f88fcb5f948f0681cc05755176">ev_tcp_exit</a>(s_tcp_echo_server.sock_listen, NULL, NULL);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _close_all_client(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_typedef" href="group__EV__UTILS__LIST.html#ga24fccfcad22348f0a471e33de0ef26af">ev_list_node_t</a> *it;</div>
<div class="line">    <span class="keywordflow">while</span> ((it = <a id="a11" name="a11"></a><a class="code hl_function" href="group__EV__UTILS__LIST.html#gac67054d191ed6447f74f7e213a4ab0cb">ev_list_pop_front</a>(&amp;s_tcp_echo_server.client_list)) != NULL)</div>
<div class="line">    {</div>
<div class="line">        tcp_client_t *client = <a id="a12" name="a12"></a><a class="code hl_define" href="group__EV__DEFINE.html#gaa3439c2bf64fcdf491aebf766124a994">EV_CONTAINER_OF</a>(it, tcp_client_t, node);</div>
<div class="line">        <a class="code hl_function" href="group__EV__TCP.html#gae81875f88fcb5f948f0681cc05755176">ev_tcp_exit</a>(client-&gt;client, _on_client_close, client);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _at_sigint(<span class="keywordtype">int</span> signum)</div>
<div class="line">{</div>
<div class="line">    (void)signum;</div>
<div class="line">    <a id="a13" name="a13"></a><a class="code hl_function" href="group__EV__ASYNC.html#ga7ceb80d48347414d38503b61724d122f">ev_async_wakeup</a>(s_tcp_echo_server.on_sigint);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _exit_application(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    _close_listen_socket();</div>
<div class="line">    _close_all_client();</div>
<div class="line">    <a id="a14" name="a14"></a><a class="code hl_function" href="group__EV__ASYNC.html#gaac84f9f673f120e354b0a2bef0c9b0b5">ev_async_exit</a>(s_tcp_echo_server.on_sigint, NULL, NULL);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _on_async_sigint(<a class="code hl_typedef" href="group__EV__ASYNC.html#ga1f2cf42cd91d80c71a074d4f0d64f95b">ev_async_t</a> *async, <span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    (void)async;</div>
<div class="line">    (void)arg;</div>
<div class="line">    _exit_application();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"> </div>
<div class="line">    atexit(_at_exit);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Stop program by one of:</span></div>
<div class="line"><span class="comment">     * + pressing Ctrl-C</span></div>
<div class="line"><span class="comment">     * + `kill -s SIGTERM PID`</span></div>
<div class="line"><span class="comment">     * + `kill -s SIGUSR1 PID`</span></div>
<div class="line"><span class="comment">     * + `kill -s SIGUSR2 PID`</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">for</span> (ret = 0; (<span class="keywordtype">unsigned</span> long)ret &lt; ARRAY_SIZE(s_term_signal); ret++)</div>
<div class="line">    {</div>
<div class="line">        signal(s_term_signal[ret], _at_sigint);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Parser listen address and port */</span></div>
<div class="line">    _setup_args(argc, argv);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize event loop */</span></div>
<div class="line">    ret = <a id="a15" name="a15"></a><a class="code hl_function" href="group__EV__EVENT__LOOP.html#ga966bbd14118f0eb2bf11717183df731d">ev_loop_init</a>(&amp;s_tcp_echo_server.loop);</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize async handler */</span></div>
<div class="line">    ret = <a id="a16" name="a16"></a><a class="code hl_function" href="group__EV__ASYNC.html#ga0aa00c7ef37c45b7a92de9516e0c2439">ev_async_init</a>(s_tcp_echo_server.loop, &amp;s_tcp_echo_server.on_sigint,</div>
<div class="line">                        _on_async_sigint, NULL);</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize listen socket */</span></div>
<div class="line">    ret = <a class="code hl_function" href="group__EV__TCP.html#ga0e24bdafbeef554d675f83abd2e62829">ev_tcp_init</a>(s_tcp_echo_server.loop, &amp;s_tcp_echo_server.sock_listen);</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Convert listen address to system struct */</span></div>
<div class="line">    <span class="keyword">struct </span>sockaddr_storage listen_addr;</div>
<div class="line">    <span class="keywordflow">if</span> (strchr(s_tcp_echo_server.addr, <span class="charliteral">&#39;:&#39;</span>) != NULL)</div>
<div class="line">    {</div>
<div class="line">        ret = <a id="a17" name="a17"></a><a class="code hl_function" href="group__EV__MISC__NET.html#ga7b97a7b3cfe9340cd3f4e1fae8d2fdb9">ev_ipv6_addr</a>(s_tcp_echo_server.addr, atoi(s_tcp_echo_server.port),</div>
<div class="line">                           (<span class="keyword">struct</span> sockaddr_in6 *)&amp;listen_addr);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        ret = <a id="a18" name="a18"></a><a class="code hl_function" href="group__EV__MISC__NET.html#ga1a07b568e683c07c35f5871c4534dc79">ev_ipv4_addr</a>(s_tcp_echo_server.addr, atoi(s_tcp_echo_server.port),</div>
<div class="line">                           (<span class="keyword">struct</span> sockaddr_in *)&amp;listen_addr);</div>
<div class="line">    }</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Bind listen address */</span></div>
<div class="line">    ret = <a id="a19" name="a19"></a><a class="code hl_function" href="group__EV__TCP.html#ga85169c0403c3c98d1263f9146142e4f5">ev_tcp_bind</a>(s_tcp_echo_server.sock_listen,</div>
<div class="line">                      (<span class="keyword">struct</span> sockaddr *)&amp;listen_addr, <span class="keyword">sizeof</span>(listen_addr));</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Start listen.</span></div>
<div class="line"><span class="comment">     * Do remember you have to call #ev_tcp_accept() to asynchronously accept</span></div>
<div class="line"><span class="comment">     * new connections.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    ret = <a id="a20" name="a20"></a><a class="code hl_function" href="group__EV__TCP.html#gaf932a1e8b3bbef6ee04d5af776d8498e">ev_tcp_listen</a>(s_tcp_echo_server.sock_listen, 1024);</div>
<div class="line">    CHECK_SUCCESS(ret);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Try to accept **one** new connection */</span></div>
<div class="line">    submit_accept_request();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * All of above operations is a `request`, you have to call #ev_loop_run()</span></div>
<div class="line"><span class="comment">     * to actually do it.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * With #EV_LOOP_MODE_DEFAULT set, after all operations are done and no</span></div>
<div class="line"><span class="comment">     * pending request left, #ev_loop_run() will return.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * In this application, this means:</span></div>
<div class="line"><span class="comment">     * 1. all client connections is closed.</span></div>
<div class="line"><span class="comment">     * 2. listing socket is closed.</span></div>
<div class="line"><span class="comment">     * 3. async handle is closed.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">return</span> <a id="a21" name="a21"></a><a class="code hl_function" href="group__EV__EVENT__LOOP.html#gad256e3c414fa271d276dd36ad7e9c263">ev_loop_run</a>(s_tcp_echo_server.loop, <a class="code hl_enumvalue" href="group__EV__EVENT__LOOP.html#gga90a7a86f6131081514dca455c2c3ce7facffec33ae1eac667b9b16284c8b5ce6c">EV_LOOP_MODE_DEFAULT</a>,</div>
<div class="line">                       <a class="code hl_define" href="group__EV__TIME.html#gaa5a1196518ed97745112d4acc839c3a4">EV_INFINITE_TIMEOUT</a>);</div>
<div class="line">}</div>
<div class="ttc" id="aev_8h_html"><div class="ttname"><a href="ev_8h.html">ev.h</a></div></div>
<div class="ttc" id="aev_8h_html_ac4d5995eaf67533e3afcf0a417136a31"><div class="ttname"><a href="ev_8h.html#ac4d5995eaf67533e3afcf0a417136a31">ev_buf_t</a></div><div class="ttdeci">struct ev_buf ev_buf_t</div><div class="ttdoc">Buffer.</div></div>
<div class="ttc" id="agroup__EV__ASYNC_html_ga0aa00c7ef37c45b7a92de9516e0c2439"><div class="ttname"><a href="group__EV__ASYNC.html#ga0aa00c7ef37c45b7a92de9516e0c2439">ev_async_init</a></div><div class="ttdeci">int ev_async_init(ev_loop_t *loop, ev_async_t **handle, ev_async_cb activate_cb, void *activate_arg)</div><div class="ttdoc">Initialize the handle.</div></div>
<div class="ttc" id="agroup__EV__ASYNC_html_ga1f2cf42cd91d80c71a074d4f0d64f95b"><div class="ttname"><a href="group__EV__ASYNC.html#ga1f2cf42cd91d80c71a074d4f0d64f95b">ev_async_t</a></div><div class="ttdeci">struct ev_async ev_async_t</div><div class="ttdoc">Async handle type.</div><div class="ttdef"><b>Definition</b> <a href="ev_8h_source.html#l03589">ev.h:3589</a></div></div>
<div class="ttc" id="agroup__EV__ASYNC_html_ga7ceb80d48347414d38503b61724d122f"><div class="ttname"><a href="group__EV__ASYNC.html#ga7ceb80d48347414d38503b61724d122f">ev_async_wakeup</a></div><div class="ttdeci">void ev_async_wakeup(ev_async_t *handle)</div><div class="ttdoc">Wake up the event loop and call the async handle&#39;s callback.</div></div>
<div class="ttc" id="agroup__EV__ASYNC_html_gaac84f9f673f120e354b0a2bef0c9b0b5"><div class="ttname"><a href="group__EV__ASYNC.html#gaac84f9f673f120e354b0a2bef0c9b0b5">ev_async_exit</a></div><div class="ttdeci">void ev_async_exit(ev_async_t *handle, ev_async_cb close_cb, void *close_arg)</div><div class="ttdoc">Destroy the structure.</div></div>
<div class="ttc" id="agroup__EV__DEFINE_html_gaa3439c2bf64fcdf491aebf766124a994"><div class="ttname"><a href="group__EV__DEFINE.html#gaa3439c2bf64fcdf491aebf766124a994">EV_CONTAINER_OF</a></div><div class="ttdeci">#define EV_CONTAINER_OF(ptr, type, member)</div><div class="ttdoc">cast a member of a structure out to the containing structure.</div><div class="ttdef"><b>Definition</b> <a href="ev_8h_source.html#l00795">ev.h:795</a></div></div>
<div class="ttc" id="agroup__EV__EVENT__LOOP_html_ga966bbd14118f0eb2bf11717183df731d"><div class="ttname"><a href="group__EV__EVENT__LOOP.html#ga966bbd14118f0eb2bf11717183df731d">ev_loop_init</a></div><div class="ttdeci">int ev_loop_init(ev_loop_t **loop)</div><div class="ttdoc">Initializes the given structure.</div></div>
<div class="ttc" id="agroup__EV__EVENT__LOOP_html_gad256e3c414fa271d276dd36ad7e9c263"><div class="ttname"><a href="group__EV__EVENT__LOOP.html#gad256e3c414fa271d276dd36ad7e9c263">ev_loop_run</a></div><div class="ttdeci">int ev_loop_run(ev_loop_t *loop, ev_loop_mode_t mode, uint32_t timeout)</div><div class="ttdoc">This function runs the event loop.</div></div>
<div class="ttc" id="agroup__EV__EVENT__LOOP_html_gaf0b54be09a1971f5acf20fb38cf5e1a5"><div class="ttname"><a href="group__EV__EVENT__LOOP.html#gaf0b54be09a1971f5acf20fb38cf5e1a5">ev_loop_exit</a></div><div class="ttdeci">int ev_loop_exit(ev_loop_t *loop)</div><div class="ttdoc">Releases all internal loop resources.</div></div>
<div class="ttc" id="agroup__EV__EVENT__LOOP_html_gafff3c1737e3eb73728b817bc6193f28c"><div class="ttname"><a href="group__EV__EVENT__LOOP.html#gafff3c1737e3eb73728b817bc6193f28c">ev_loop_t</a></div><div class="ttdeci">struct ev_loop ev_loop_t</div><div class="ttdoc">Typedef of #ev_loop.</div><div class="ttdef"><b>Definition</b> <a href="ev_8h_source.html#l03464">ev.h:3464</a></div></div>
<div class="ttc" id="agroup__EV__EVENT__LOOP_html_gga90a7a86f6131081514dca455c2c3ce7facffec33ae1eac667b9b16284c8b5ce6c"><div class="ttname"><a href="group__EV__EVENT__LOOP.html#gga90a7a86f6131081514dca455c2c3ce7facffec33ae1eac667b9b16284c8b5ce6c">EV_LOOP_MODE_DEFAULT</a></div><div class="ttdeci">@ EV_LOOP_MODE_DEFAULT</div><div class="ttdoc">Runs the event loop until there are no more active and referenced handles or requests.</div><div class="ttdef"><b>Definition</b> <a href="ev_8h_source.html#l03392">ev.h:3392</a></div></div>
<div class="ttc" id="agroup__EV__MISC__NET_html_ga1a07b568e683c07c35f5871c4534dc79"><div class="ttname"><a href="group__EV__MISC__NET.html#ga1a07b568e683c07c35f5871c4534dc79">ev_ipv4_addr</a></div><div class="ttdeci">int ev_ipv4_addr(const char *ip, int port, struct sockaddr_in *addr)</div><div class="ttdoc">Convert IPv4 ip and port into network address.</div></div>
<div class="ttc" id="agroup__EV__MISC__NET_html_ga7b97a7b3cfe9340cd3f4e1fae8d2fdb9"><div class="ttname"><a href="group__EV__MISC__NET.html#ga7b97a7b3cfe9340cd3f4e1fae8d2fdb9">ev_ipv6_addr</a></div><div class="ttdeci">int ev_ipv6_addr(const char *ip, int port, struct sockaddr_in6 *addr)</div><div class="ttdoc">Convert IPv6 ip and port into network address.</div></div>
<div class="ttc" id="agroup__EV__MISC__NET_html_gae12ee3b5ba3619bdfaf1002831c2f4f6"><div class="ttname"><a href="group__EV__MISC__NET.html#gae12ee3b5ba3619bdfaf1002831c2f4f6">ev_ipv4_name</a></div><div class="ttdeci">int ev_ipv4_name(const struct sockaddr_in *addr, int *port, char *ip, size_t len)</div><div class="ttdoc">Convert IPv4 network address into ip and port.</div></div>
<div class="ttc" id="agroup__EV__MISC_html_ga047bab4c5d508257ed3dad1e83b0af5e"><div class="ttname"><a href="group__EV__MISC.html#ga047bab4c5d508257ed3dad1e83b0af5e">ev_buf_make</a></div><div class="ttdeci">ev_buf_t ev_buf_make(void *buf, size_t len)</div><div class="ttdoc">Constructor for ev_buf_t.</div></div>
<div class="ttc" id="agroup__EV__TCP_html_ga0e24bdafbeef554d675f83abd2e62829"><div class="ttname"><a href="group__EV__TCP.html#ga0e24bdafbeef554d675f83abd2e62829">ev_tcp_init</a></div><div class="ttdeci">int ev_tcp_init(ev_loop_t *loop, ev_tcp_t **tcp)</div><div class="ttdoc">Initialize a tcp socket.</div></div>
<div class="ttc" id="agroup__EV__TCP_html_ga17d65ad384637a249833980448d8b9ac"><div class="ttname"><a href="group__EV__TCP.html#ga17d65ad384637a249833980448d8b9ac">ev_tcp_t</a></div><div class="ttdeci">struct ev_tcp ev_tcp_t</div><div class="ttdoc">TCP socket.</div><div class="ttdef"><b>Definition</b> <a href="ev_8h_source.html#l03749">ev.h:3749</a></div></div>
<div class="ttc" id="agroup__EV__TCP_html_ga2bfe44c7a94d2c476a7fc2cacd56b996"><div class="ttname"><a href="group__EV__TCP.html#ga2bfe44c7a94d2c476a7fc2cacd56b996">ev_tcp_write</a></div><div class="ttdeci">int ev_tcp_write(ev_tcp_t *sock, ev_buf_t *bufs, size_t nbuf, ev_tcp_write_cb cb, void *arg)</div><div class="ttdoc">Write data.</div></div>
<div class="ttc" id="agroup__EV__TCP_html_ga4b5bd52b3f680a0d1093cbd818886cf7"><div class="ttname"><a href="group__EV__TCP.html#ga4b5bd52b3f680a0d1093cbd818886cf7">ev_tcp_read</a></div><div class="ttdeci">int ev_tcp_read(ev_tcp_t *sock, ev_buf_t *bufs, size_t nbuf, ev_tcp_read_cb cb, void *arg)</div><div class="ttdoc">Read data.</div></div>
<div class="ttc" id="agroup__EV__TCP_html_ga80e57513fc95a866f41631c6477440ca"><div class="ttname"><a href="group__EV__TCP.html#ga80e57513fc95a866f41631c6477440ca">ev_tcp_accept</a></div><div class="ttdeci">int ev_tcp_accept(ev_tcp_t *acpt, ev_tcp_t *conn, ev_tcp_accept_cb cb, void *arg)</div><div class="ttdoc">Accept a connection from listen socket.</div></div>
<div class="ttc" id="agroup__EV__TCP_html_ga85169c0403c3c98d1263f9146142e4f5"><div class="ttname"><a href="group__EV__TCP.html#ga85169c0403c3c98d1263f9146142e4f5">ev_tcp_bind</a></div><div class="ttdeci">int ev_tcp_bind(ev_tcp_t *tcp, const struct sockaddr *addr, size_t addrlen)</div><div class="ttdoc">Bind the handle to an address and port. addr should point to an initialized struct sockaddr_in or str...</div></div>
<div class="ttc" id="agroup__EV__TCP_html_ga931b5982c7e44faa0ad7371934b0efdb"><div class="ttname"><a href="group__EV__TCP.html#ga931b5982c7e44faa0ad7371934b0efdb">ev_tcp_getpeername</a></div><div class="ttdeci">int ev_tcp_getpeername(ev_tcp_t *sock, struct sockaddr *name, size_t *len)</div><div class="ttdoc">Get the address of the peer connected to the socket.</div></div>
<div class="ttc" id="agroup__EV__TCP_html_gae81875f88fcb5f948f0681cc05755176"><div class="ttname"><a href="group__EV__TCP.html#gae81875f88fcb5f948f0681cc05755176">ev_tcp_exit</a></div><div class="ttdeci">void ev_tcp_exit(ev_tcp_t *sock, ev_tcp_close_cb cb, void *arg)</div><div class="ttdoc">Destroy socket.</div></div>
<div class="ttc" id="agroup__EV__TCP_html_gaf932a1e8b3bbef6ee04d5af776d8498e"><div class="ttname"><a href="group__EV__TCP.html#gaf932a1e8b3bbef6ee04d5af776d8498e">ev_tcp_listen</a></div><div class="ttdeci">int ev_tcp_listen(ev_tcp_t *sock, int backlog)</div><div class="ttdoc">Start listening for incoming connections.</div></div>
<div class="ttc" id="agroup__EV__TIME_html_gaa5a1196518ed97745112d4acc839c3a4"><div class="ttname"><a href="group__EV__TIME.html#gaa5a1196518ed97745112d4acc839c3a4">EV_INFINITE_TIMEOUT</a></div><div class="ttdeci">#define EV_INFINITE_TIMEOUT</div><div class="ttdoc">Infinite timeout.</div><div class="ttdef"><b>Definition</b> <a href="ev_8h_source.html#l03206">ev.h:3206</a></div></div>
<div class="ttc" id="agroup__EV__UTILS__LIST_html_ga24fccfcad22348f0a471e33de0ef26af"><div class="ttname"><a href="group__EV__UTILS__LIST.html#ga24fccfcad22348f0a471e33de0ef26af">ev_list_node_t</a></div><div class="ttdeci">struct ev_list_node ev_list_node_t</div><div class="ttdoc">The list node. This node must put in your struct.</div></div>
<div class="ttc" id="agroup__EV__UTILS__LIST_html_ga2eb6fa551d8031cd5ced350f25c6451a"><div class="ttname"><a href="group__EV__UTILS__LIST.html#ga2eb6fa551d8031cd5ced350f25c6451a">EV_LIST_INIT</a></div><div class="ttdeci">#define EV_LIST_INIT</div><div class="ttdoc">Static initializer for ev_list_t.</div><div class="ttdef"><b>Definition</b> <a href="ev_8h_source.html#l00405">ev.h:405</a></div></div>
<div class="ttc" id="agroup__EV__UTILS__LIST_html_ga3ecb4fcafe66af1ba7d875e27e0bcadd"><div class="ttname"><a href="group__EV__UTILS__LIST.html#ga3ecb4fcafe66af1ba7d875e27e0bcadd">ev_list_erase</a></div><div class="ttdeci">void ev_list_erase(ev_list_t *handler, ev_list_node_t *node)</div><div class="ttdoc">Delete a exist node.</div></div>
<div class="ttc" id="agroup__EV__UTILS__LIST_html_ga5b3f16540f29df5627dbef22f5571b97"><div class="ttname"><a href="group__EV__UTILS__LIST.html#ga5b3f16540f29df5627dbef22f5571b97">ev_list_t</a></div><div class="ttdeci">struct ev_list ev_list_t</div><div class="ttdoc">Double Linked List.</div></div>
<div class="ttc" id="agroup__EV__UTILS__LIST_html_gac224bce0c5553feaff3e34c759e3a676"><div class="ttname"><a href="group__EV__UTILS__LIST.html#gac224bce0c5553feaff3e34c759e3a676">ev_list_push_back</a></div><div class="ttdeci">void ev_list_push_back(ev_list_t *handler, ev_list_node_t *node)</div><div class="ttdoc">Insert a node to the tail of the list.</div></div>
<div class="ttc" id="agroup__EV__UTILS__LIST_html_gac67054d191ed6447f74f7e213a4ab0cb"><div class="ttname"><a href="group__EV__UTILS__LIST.html#gac67054d191ed6447f74f7e213a4ab0cb">ev_list_pop_front</a></div><div class="ttdeci">ev_list_node_t * ev_list_pop_front(ev_list_t *handler)</div><div class="ttdoc">Get the first node and remove it from the list.</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jan 6 2025 08:44:00 for libev by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.1 </li>
  </ul>
</div>
</body>
</html>
